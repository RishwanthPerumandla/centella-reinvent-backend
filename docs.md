### **Technical Overview of the Project**
This project integrates **FastAPI**, **Celery**, **Docker**, and **REINVENT** to create a **Molecular Design Pipeline** that enables running molecule design tasks asynchronously and dynamically using containerized services.

---

## **Key Components and Why We Used Them**
Below is a breakdown of the core technologies used in this project, along with explanations of why they were chosen.

### **1. FastAPI (Backend API Framework)**
   - **Why FastAPI?**
     - It's **fast** and built on Starlette & Pydantic.
     - It provides **automatic OpenAPI documentation**.
     - **Asynchronous capabilities** make it ideal for handling concurrent API requests.
   - **What it does here?**
     - Handles **API requests** for submitting molecule design tasks.
     - Routes requests to **Celery workers** for background processing.

---

### **2. Celery (Asynchronous Task Queue)**
   - **Why Celery?**
     - It allows executing tasks **asynchronously in the background**.
     - Supports distributed task execution across multiple workers.
     - Ensures **fault tolerance and retries** in case of failure.
   - **What it does here?**
     - Handles the **task execution pipeline** for molecule design.
     - Processes requests independently from FastAPI.
     - Interacts with **Docker** to start REINVENT dynamically inside containers.

---

### **3. Redis (Message Broker for Celery)**
   - **Why Redis?**
     - Acts as a **fast in-memory message broker** for Celery.
     - Helps in **queuing tasks** efficiently.
   - **What it does here?**
     - Stores task **status updates**.
     - Allows FastAPI to communicate with Celery workers asynchronously.

---

### **4. Docker & Docker Compose (Containerization & Orchestration)**
   - **Why Docker?**
     - Ensures **environment consistency** across deployments.
     - Allows for **easy scaling** of services.
   - **Why Docker Compose?**
     - Manages multi-container environments efficiently.
   - **What it does here?**
     - Containerizes:
       - **FastAPI Backend** (API)
       - **Celery Worker** (Task Processor)
       - **Redis** (Message Queue)
       - **PostgreSQL** (Database)
       - **REINVENT** (Molecular Design Engine)

---

### **5. REINVENT (Molecular Design Engine)**
   - **Why REINVENT?**
     - A powerful AI-driven **molecule generation tool**.
     - Provides reinforcement learning capabilities for drug discovery.
   - **What it does here?**
     - Runs inside a **separate container** to generate molecular structures.
     - Reads configuration files dynamically generated by Celery workers.
     - Outputs **CSV results** with newly generated molecules.

---

### **6. PostgreSQL (Database)**
   - **Why PostgreSQL?**
     - A reliable, scalable, and **robust relational database**.
   - **What it does here?**
     - Stores **job metadata** related to molecule design tasks.
     - Keeps track of **task submissions** and results.

---

## **Workflow: How It All Works Together**
1. **User submits a molecule design task** via FastAPI (`/api/v1/molecule/design`).
2. FastAPI **stores task metadata** in PostgreSQL and pushes the task to Celery.
3. Celery picks up the task and **dynamically generates a TOML config file**.
4. Celery **spins up a Docker container** for REINVENT and executes the command inside it.
5. **REINVENT reads the config**, generates molecules, and saves the results.
6. Once the process completes:
   - Celery **updates the task status**.
   - Results are saved in `/reinvent/results/` and are accessible via FastAPI.
7. **User fetches results** via the `/api/v1/molecule/{task_id}/result` endpoint.

---

## **Challenges & How We Solved Them**
| Challenge | Solution |
|-----------|----------|
| **Celery tasks not running** | Ensured Redis was properly set up as a message broker. |
| **REINVENT config files not found** | Ensured Celery workers had correct **volume mounts** and permission settings. |
| **Docker container stopped after execution** | Modified `docker exec` to use dynamically triggered containers. |
| **FastAPI and Celery communication issues** | Ensured proper **task routing** and used `delay()` correctly. |

---

## **Why Is This Approach Powerful?**
**Scalability:** Celery can distribute tasks across multiple workers.  
**Resilience:** If a Celery worker fails, tasks can be retried.  
**Efficiency:** FastAPI is highly optimized for concurrent requests.  
**Reproducibility:** Docker ensures consistent environments.  
**Flexibility:** REINVENT can be replaced with any other AI model.

---

## **Future Improvements**
- Implement a **Task Scheduler** for periodic molecular design execution.
- Store **task logs & metadata** in PostgreSQL for better tracking.
- Enable **GPU support** inside REINVENT containers for faster molecule generation.
